# Описание проекта
Сервис для предсказания пола пользователя по его cookies. 
Данный проект является логическим продолжением участия в соревновании MTS ML Cup.

Данные взяты с соревнования MTS ML Cup:

https://ods.ai/competitions/mtsmlcup/data

## UI Demo
![alt text](demo/demo.gif?raw=true)

## Описание данных
Предобработка, аггрегация и создание новых фич произведена в 0.Data_preparing.ipng.

Описание колонок аггрегированного файла с данными:
* 'part_of_day_day' – кол-во визитов пользователя днем
* 'part_of_day_evening' – кол-во визитов пользователя вечером
* 'part_of_day_morning' – кол-во визитов пользователя утром
* 'part_of_day_night' – кол-во визитов пользователя ночью
* 'sum_visits' – кол-во визитов пользователя
* 'day_pct' – доля визитов пользователя днем
* 'evening_pct' – доля визитов пользователя вечером
* 'morning_pct' – доля визитов пользователя утром
* 'night_pct' – доля визитов пользователя ночью
* 'act_days' – кол-во дней, в которые пользователь совершил визит пользователя
* 'request_cnt' - кол-во запросов пользователя
* 'avg_req_per_day' - среднее кол-во запросов пользователя
* 'period_days' - кол-во дней между первым и последним визитом пользователя
* 'act_days_pct' - доля дней, когда пользователь совершал визит
* 'cpe_type_cd - тип устройства
* 'cpe_model_os_type' - операционная система устройства
* 'cpe_manufacturer_name' -производитель устройства
* 'price' - цена устройства пользователя
* 'region_cnt' - кол-во уникальных регионов, из которых был совершен визит
* 'city_cnt' - кол-во уникальных городов, из которых был совершен визит
* 'url_host_cnt' - кол-во уникальных ссылок, с которых был совершен визит
* 'user_id' – ID пользователя

Таргет:
* 'is_male' – 1: мужчина, 0: женщина

## Структура проекта
- `/backend` - Папка с проектом FastAPI
- `/frontend` - Папка с проектом Streamlit
- `/config` - Папка, содержащая конфигурационный файл
- `/data` - Папка, содержащая исходные данные, обработанные данные, уникальные значения в формате JSON, а также неразмеченный файл для подачи на вход модели
- `/demo` - Папка, содержащая демо работы сервиса в Streamlit UI в формате gif
- `/models` - Папка, содержащая сохраненную модель после тренировки, а также объект optuna.study
- `/notebooks` - Папка, содержащая jupyter ноутбуки с предварительным анализом данных
- `/report` - Папка, содержащая информацию о лучших параметрах и метриках после обучения

## Запуск проекта
- Сборка образов и запуск контейнеров backend и frontend выполняется из корневой папки проекта следующей командой:

`docker compose up -d --build`